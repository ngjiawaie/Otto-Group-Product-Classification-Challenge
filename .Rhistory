getwd()
library(caret)
library(rpart)
library(tree)
library(ISLR)
rm(list=ls())
set.seed(5)
setwd("C:/Users/teoze/Desktop/decision_tree/assingment3/Otto-Group-Product-Classification-Challenge")
train_data <- read.csv("train.csv")
test_data <- read.csv("test.csv")
dim(train_data)
train_data <- train_data[,-1]
train <- downSample(x = data[, -ncol(data)],y = data$target)
train <- downSample(x = data[, -ncol(train_data)],y = data$target)
train <- downSample(x = data[, -ncol(train_data)],y = train_data$target)
train <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
train
train_d <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
table(train_d$target)
table(train_d$target)
rm(list=ls())
library(ISLR)
library(tree)
library(rpart)
library(caret)
set.seed(5)
setwd("C:/Users/teoze/Desktop/decision_tree/assingment3/Otto-Group-Product-Classification-Challenge")
train_data <- read.csv("train.csv")
test_data <- read.csv("test.csv")
train_data <- train_data[,-1]
train_d <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
table(train_d$target)
table(train_d)
table(train_d$target)
train_d$target
train_d <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
View(train_d)
View(train_d)
table(train_d$Class)
test <- sample(1:nrow(train_data),nrow(train_data)/2)
test_target <- test_d$target
test_target <- test$target
test <- sample(1:nrow(train_data),nrow(train_data)/2)
test_target <- test$target
test <- sample(1:nrow(train_data),nrow(train_data)/2)
test_d <- train_data[test]
test_d <- train_data[test,]
test_target <- test_d$target
train_d <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
table(train_d$Class)
tree_model <- tree(Class ~., train_d)
summary(tree_model)
plot(tree_model)
text(tree_model, pretty = 0)
tree_predict <- predict(tree_model, test_d, type="class")
mean(tree_predict != test_target) #0.4144607, abit high
set.seed(3)
cv_tree <- cv.tree(tree_model, FUN = prune.misclass)
names(cv_tree)
plot(cv_tree$size , cv_tree$dev, type="b")
prune_model <- prune.misclass(tree_model, best = 10)
plot(prune_model)
text(prune_model, pretty=0)
tree_predict <- predict(prune_model, test_d, type="class")
mean(tree_predict != test_target)
set.seed(4)
tree_model2 <- rpart(target ~., data = train_d, method="class")
tree_model2 <- rpart(Class ~., data = train_d, method="class")
summary(tree_model2)
plot(tree_model2)
text(tree_model2, pretty = 0)
printcp(tree_model2)
plotcp(tree_model2, upper="size")
tree_predict2 <- predict(tree_model2, test_d, type="class")
mean(tree_predict2 != test_target)
prune_tree2<- prune(tree_model2, cp = tree_model2$cptable[which.min(tree_model2$cptable[,"xerror"]),"CP"])
printcp(prune_tree2)
plot(prune_tree2,uniform=TRUE)
text(prune_tree2,pretty = 0)
tree_predict2 <- predict(prune_tree2, test_d, type="class")
mean(tree_predict2 != test_target)
tree_model <- tree(Class ~., train_d)
summary(tree_model)
plot(tree_model)
text(tree_model, pretty = 0)
tree_model <- tree(Class ~., train_d)
summary(tree_model)
plot(tree_model)
text(tree_model, pretty = 0)
tree_predict <- predict(tree_model, test_d, type="class")
mean(tree_predict != test_target) #0.4144607, abit high
printcp(tree_model)
summary(tree_model)
rm(list=ls())
library(ISLR)
library(tree)
library(rpart)
library(caret)
set.seed(5)
setwd("C:/Users/teoze/Desktop/decision_tree/assingment3/Otto-Group-Product-Classification-Challenge")
train_data <- read.csv("train.csv")
test_data <- read.csv("test.csv")
dim(train_data)
dim(test_data)
head(train_data)
head(test_data)
train_data <- train_data[,-1]
test <- sample(1:nrow(train_data),nrow(train_data)/2)
test_d <- train_data[test,]
test_target <- test_d$target
train_d <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
table(train_d$Class)
tree_model <- tree(Class ~., train_d)
summary(tree_model)
plot(tree_model)
text(tree_model, pretty = 0)
tree_predict <- predict(tree_model, test_d, type="class")
mean(tree_predict != test_target) #0.4144607, abit high
set.seed(3)
cv_tree <- cv.tree(tree_model, FUN = prune.misclass)
names(cv_tree)
plot(cv_tree$size , cv_tree$dev, type="b")
prune_model <- prune.misclass(tree_model, best = 10)
plot(prune_model)
text(prune_model, pretty=0)
prune_model <- prune.misclass(tree_model, best = 11)
rm(list=ls())
library(ISLR)
library(tree)
library(rpart)
library(caret)
set.seed(5)
setwd("C:/Users/teoze/Desktop/decision_tree/assingment3/Otto-Group-Product-Classification-Challenge")
train_data <- read.csv("train.csv")
test_data <- read.csv("test.csv")
train_data <- train_data[,-1]
test <- sample(1:nrow(train_data),nrow(train_data)/2)
test_d <- train_data[test,]
test_target <- test_d$target
train_d <- downSample(x = train_data[, -ncol(train_data)],y = train_data$target)
table(train_d$Class)
tree_model <- tree(Class ~., train_d)
summary(tree_model)
plot(tree_model)
text(tree_model, pretty = 0)
tree_predict <- predict(tree_model, test_d, type="class")
mean(tree_predict != test_target) #0.505931, abit high
set.seed(3)
cv_tree <- cv.tree(tree_model, FUN = prune.misclass)
names(cv_tree)
plot(cv_tree$size , cv_tree$dev, type="b")
prune_model <- prune.misclass(tree_model, best = 10)
plot(prune_model)
text(prune_model, pretty=0)
tree_predict <- predict(prune_model, test_d, type="class")
mean(tree_predict != test_target)
set.seed(4)
tree_model2 <- rpart(Class ~., data = train_d, method="class")
summary(tree_model2)
plot(tree_model2)
text(tree_model2, pretty = 0)
printcp(tree_model2)
plotcp(tree_model2, upper="size")
tree_predict2 <- predict(tree_model2, test_d, type="class")
mean(tree_predict2 != test_target)
prune_tree2<- prune(tree_model2, cp = tree_model2$cptable[which.min(tree_model2$cptable[,"xerror"]),"CP"])
printcp(prune_tree2)
plot(prune_tree2,uniform=TRUE)
text(prune_tree2,pretty = 0)
tree_predict2 <- predict(prune_tree2, test_d, type="class")
mean(tree_predict2 != test_target)
